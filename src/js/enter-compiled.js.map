{"version":3,"sources":["enter.js"],"names":[],"mappings":"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","file":"enter-compiled.js","sourcesContent":["\"use strict\"\r\nimport Model from \"./model.js\"\r\n\r\n//enter\r\nvar map = L.map('mapid', {\r\n    center: [55.75, 37.716],\r\n    zoom: 8,\r\n});\r\n\r\nL.tileLayer(\r\n'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n {\r\n     attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n}).addTo(map);\r\n\r\n\r\n//BARS LAYAER\r\nlet bars = new L.LayerGroup();\r\nlet barsIcon = L.icon({\r\n\ticonUrl: 'https://a.tiles.mapbox.com/v4/marker/pin-m-bar+438fd3.png?access_token=pk.eyJ1IjoiZ2l0aHViIiwiYSI6IjEzMDNiZjNlZGQ5Yjg3ZjBkNGZkZWQ3MTIxN2FkODIxIn0.o0lbEdOfJYEOaibweUDlzA',\r\n    iconAnchor: [16, 37],\r\n    popupAnchor: [0, -28]\r\n\r\n});\r\nlet {type:bars_type,features:bars_features} = Model.bars();\r\nconsole.log()\r\nlet onEachFeature=(feature, layer) => {\r\n    var popupContent = \"<p>name:\"+feature.properties.name+\"</p><p>address:\"+feature.properties.address+\"</p>\";\r\n   \tlayer.bindPopup(popupContent);\r\n};\r\nL.geoJson(bars_features,{\r\n    onEachFeature: onEachFeature,\r\n    pointToLayer: function (feature, latlng) {\r\n    \t\t\t\treturn L.marker(latlng, {icon: barsIcon});\r\n    }\r\n}).addTo(bars);\r\n\r\n//SOME LAYAER\r\nlet some = new L.LayerGroup();\r\nlet {features:some_features} = Model.some();\r\n\r\nlet onEachFeature2=(feature, layer) => {\r\n    var popupContent = \"<p>name:\"+feature.properties.name+\"</p><p>address:\"+feature.properties.address+\"</p>\";\r\n   \tlayer.bindPopup(popupContent);\r\n};\r\n\r\nL.geoJson(some_features,{\r\n    onEachFeature: onEachFeature2,\r\n    pointToLayer: function (feature, latlng) {\r\n    \t\t\t\treturn L.marker(latlng);\r\n    }\r\n}).addTo(some);\r\n\r\n//METRO LAYER\r\nlet metro = new L.LayerGroup();\r\n\r\nlet onEachFeature1=(feature, layer) => {\r\n    var popupContent = feature.properties[\"name_ru\"];\r\n   \tlayer.bindPopup(popupContent);\r\n};\r\n\r\nvar customLayer = L.geoJson(null, {\r\n    onEachFeature: onEachFeature1,\r\n    pointToLayer: function (feature, latlng) {\r\n    \t\t\t\treturn L.marker(latlng);\r\n    }});\r\n\r\n\r\n\r\nomnivore.csv('https://raw.githubusercontent.com/nextgis/metro4all/master/data/msk/portals.csv',{latfield: 'lat',\r\n    lonfield: 'lon',\r\n    delimiter: ';'\r\n    },customLayer\r\n    ).addTo(metro);\r\nvar {_layers}=omnivore.csv('https://raw.githubusercontent.com/nextgis/metro4all/master/data/msk/portals.csv',{latfield: 'lat',\r\n    lonfield: 'lon',\r\n    delimiter: ';'\r\n    }\r\n    )\r\nconsole.log(_layers);\r\n\r\n\r\n//Controls\r\n\r\n\r\nvar baselays = {\r\n    \"<span id=\\\"some_control\\\" class='my-layer-item'>some</span>\": some,\r\n    \"<span id=\\\"bars_control\\\" class='my-layer-item'>Bars</span>\": bars,\r\n    \"<span id=\\\"metro_control\\\" class='my-layer-item'>Metro</span>\": metro,\r\n\t\t};\r\n\r\nL.control.layers(baselays).addTo(map);\r\n\r\nlet bars_control = document.getElementById(\"bars_control\");\r\nlet some_control = document.getElementById(\"some_control\");\r\nlet metro_control = document.getElementById(\"metro_control\");\r\n\r\nbars_control.addEventListener(\"click\",(e)=>{\r\n    map.setView([38.898321,-77.039882],12\r\n        //,{pan:{animate: true, duration:3}}\r\n        )\r\n    // map.panTo([38.898321,-77.039882], {\r\n    //     animate: true,\r\n    //     duration:2\r\n    // });\r\n    var source   = document.getElementById(\"table-template\").innerHTML;\r\n    var template = Handlebars.compile(source);\r\n    var context = {data:bars_features};\r\n    var html    = template(context);\r\n    document.getElementById(\"table\").innerHTML = html;\r\n});\r\n\r\nsome_control.addEventListener(\"click\",(e)=>{\r\n    map.setView([53.228430, 50.229303],12\r\n        )\r\n});\r\n\r\nmetro_control.addEventListener(\"click\",(e)=>{\r\n    map.setView([55.751, 37.716],12\r\n    )\r\n});\r\n\r\nfunction check(element,substr) {\r\n    if (element.toLowerCase().indexOf(substr) !=-1) return true;\r\n  };\r\n\r\nfilter__name.onkeyup = (e,template)=> {\r\n    //фильтрация\r\n    let newData = [];\r\n    var substr  = filter__name.value.toLowerCase();\r\n    for (var i=0;i<bars_features.length;i++) {\r\n          if (check(bars_features[i][\"properties\"][\"name\"],substr)) {\r\n              newData.push(bars_features[i])\r\n            }\r\n        };\r\n\r\n    //вывод списка филтрации\r\n    var source   = document.getElementById(\"table-template\").innerHTML;\r\n    var template = Handlebars.compile(source);\r\n    let context = {data:newData};\r\n    let html = template(context);\r\n    document.getElementById(\"table\").innerHTML = html;\r\n\r\n    bars.clearLayers();\r\n        L.geoJson(newData,{\r\n            onEachFeature: onEachFeature,\r\n            pointToLayer: function (feature, latlng) {\r\n                            return L.marker(latlng, {icon: barsIcon});\r\n            }\r\n        }).addTo(bars);\r\n\r\n\r\n\r\n\r\n    };\r\nlet chooseMarker = (e) => {\r\n    let parent =e.target.closest(\".geoObject\");\r\n    let choose  = parent.querySelector(\".name\").innerText;\r\n    for (var i=0;i<bars_features.length;i++) {\r\n          if (bars_features[i][\"properties\"][\"name\"]===choose) {\r\n               map.panTo([bars_features[i][\"geometry\"][\"coordinates\"][0],bars_features[i][\"geometry\"][\"coordinates\"][1]], {\r\n                   animate: true,\r\n                   duration:2\r\n              });\r\n            }\r\n        };\r\n    //console.log(choose);\r\n};\r\n\r\n\r\ntable.addEventListener(\"click\",chooseMarker);"]}